<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title th:text="${isNew} ? 'Добавить репетицию' : 'Редактировать репетицию'"></title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</head>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<style>
    body {
    background-image: url('/uploads/photos/edit.png');
    background-size: cover;
    background-repeat: no-repeat;
    background-attachment: fixed;
}
</style>
<body>
<div class="container mt-4">
    <h1 class="mb-3"
        th:text="${isNew} ? 'Добавить новую репетицию' : 'Редактировать репетицию'"></h1>

    <form th:action="@{(${isNew} ? '/rehearsals/add' : '/rehearsals/update')}"
          method="post">
        <!-- Скрытое поле rehearsalId только в режиме редактирования -->
        <input th:if="${!isNew}"
               type="hidden"
               name="rehearsalId"
               th:value="${rehearsal.rehearsalId}"/>

        <div class="row g-2 align-items-end">
            <div class="col-md-2">
                <label for="date" class="form-label">Дата</label>
                <input type="date"
                       id="date"
                       name="date"
                       class="form-control"
                       th:value="${rehearsal.date}"
                       required/>
            </div>

            <div class="col-md-2">
                <label for="time" class="form-label">Время</label>
                <input type="time"
                       id="time"
                       name="time"
                       class="form-control"
                       th:value="${rehearsal.time}"
                       required/>
            </div>

            <div class="col-md-2">
                <label for="room" class="form-label">Зал</label>
                <input type="text"
                       id="room"
                       name="room"
                       class="form-control"
                       th:value="${rehearsal.rehearsalRoom}"
                       placeholder="Зал 1"
                       required/>
            </div>

            <div class="col-md-6">
                <label class="form-label">Актёры</label>
                <div class="border rounded p-2" style="max-height: 200px; overflow-y: auto;">
                    <!-- Итерация по списку всех актёров -->
                    <div th:each="actor : ${allActors}" class="form-check">
                        <input class="form-check-input"
                               type="checkbox"
                               th:id="'actor_' + ${actor.workerId}"
                               th:name="actorIds"
                               th:value="${actor.workerId}"
                               th:checked="${rehearsal.workers.![workerId].contains(actor.workerId)}"/>
                        <label class="form-check-label"
                               th:for="'actor_' + ${actor.workerId}"
                               th:text="${actor.fio}">
                            Иван Иванов
                        </label>
                    </div>
                </div>
                <div class="form-text">
                    Удерживайте Ctrl (Cmd) для выбора нескольких актёров.
                </div>
            </div>

            <div class="col-md-12 mt-3">
                <label for="comment" class="form-label">Комментарий</label>
                <textarea id="comment"
                          name="comment"
                          class="form-control"
                          rows="2"
                          th:text="${rehearsal.comment}"
                          placeholder="Что репетируют..."></textarea>
            </div>

            <div class="col-md-12 mt-3 text-end">
                <button type="submit"
                        class="btn btn-primary"
                        th:text="${isNew} ? 'Добавить' : 'Сохранить'">
                    Сохранить
                </button>
            </div>
        </div>
    </form>
</div>
</body>
</html>
