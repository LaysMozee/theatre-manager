<!DOCTYPE html>
<html lang="ru" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title th:text="${condition != null} ? 'Редактировать состояние' : 'Добавить состояние'">Форма состояния</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" />
</head>
<body>
<div class="container mt-5">

    <h1 th:text="${condition != null} ? 'Редактировать состояние' : 'Добавить состояние'">Форма</h1>

    <form th:action="${condition != null} ? @{/conditions/update} : @{/conditions/save}"
          method="post">
        <!-- Если мы редактируем, передаём скрытое поле с ID состояния -->
        <input type="hidden" th:if="${condition != null}"
               name="conditionId" th:value="${condition.conditionId}" />

        <div class="mb-3">
            <label for="requisiteId" class="form-label">Выберите реквизит</label>
            <select id="requisiteId" name="requisiteId" class="form-select" required>
                <option th:each="r : ${allRequisites}"
                        th:value="${r.id}"
                        th:text="${r.title}"
                        th:selected="${condition != null} ? ${r.id} == ${condition.requisiteId} : false">
                    Шляпа
                </option>
            </select>
        </div>

        <div class="mb-3">
            <label for="conditionTypeId" class="form-label">Тип состояния</label>
            <select id="conditionTypeId" name="conditionTypeId" class="form-select" required>
                <option th:each="ct : ${allConditionTypes}"
                        th:value="${ct.conditionTypeId}"
                        th:text="${ct.conditionTypeName}"
                        th:selected="${condition != null} ? ${ct.conditionTypeId} == ${condition.conditionTypeId} : false">
                    Утерян
                </option>
            </select>
        </div>

        <div class="mb-3">
            <label for="date" class="form-label">Дата</label>
            <input type="date" id="date" name="date" class="form-control"
                   th:value="${condition != null} ? ${#dates.format(condition.date, 'yyyy-MM-dd')} : ''" required />
        </div>

        <button type="submit" class="btn btn-success">Сохранить</button>
        <a href="/conditions" class="btn btn-secondary ms-2">Отмена</a>
    </form>

</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
